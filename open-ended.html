<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="style.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap" rel="stylesheet">

    <title>ZIUQ 2.0</title>
  </head>
  <body class="card card-body text-center">
    <h1 class="titoli"> ZIUQ </h1>

    <hr/>
    
    <p class="lead form-group testo"> &#128071; Scrivi la domanda &#128071; 
        <br/>
        <div id="suggerimento" class="testo"></div>
        <br/>
        <input class="form-control testo" type="text" id="domanda_scelta" placeholder="Inizia a scrivere..."
        style="text-align:center;"/> 
        <br/>

        <input type="button" id="scegli" value="Verifica" class="btn btn-success btn-bg testo" /> 
        <input type="button" id="suggerisci" value="Suggerisci" class="btn btn-primary btn-sm testo" /> 
        <input type="button" id="reset" value="Reset" class="btn btn-danger btn-sm testo"/> 
    </p>

    <p class="lead testo"> <mark> La risposta deve essere: 
        <span id="risposta" class="h3"> 
            <!--spinner-->

        </span> 
    </mark> </p>

    <div class="alert alert-light testo" role="alert">
        Idea: cerca parole chiave simili, ad es.: 
        Deserto del Sahara -> <em> deserto </em>,
         Volga -> <em> fiume </em>,
         Mark Twain -> <em> chi ha scritto </em>, ecc.
<br/>
         Se non hai idea <strong> usa i suggerimenti! </strong> 
      </div>
      
    
    <p class="lead testo"> 
         <a href="open-ended.html" class="btn btn-outline-primary btn-lg"> Nuova Partita </a> 
    </p>

    <h2 class="titoli">Istruzioni</h2>
<p class="testo">
    Immagina un tipo di quiz unico e coinvolgente, nel quale invece di ricevere una domanda e cercare 
    la risposta corretta, il processo viene invertito. In questo quiz a risposta chiusa 
    invertita, ti verrà fornita la risposta: la tua sfida sarà formulare la domanda adeguata! 
    
    Questo richiederà non solo una conoscenza approfondita dell'argomento trattato, 
    ma anche un'elevata creatività nel formulare domande pertinenti. 
</p>
    <p class="alert alert-info"> Sono presenti: <strong id="sizedataset"> </strong> domande/risposte. </p>
    <p> <a href="https://capolooper.it">Salvatore Capolupo</a> - ZIUQ - 18/19 febbraio 2024 </p>
    
    <a href="https://www.freecounterstat.com" title="free counters"><img src="https://counter8.optistats.ovh/private/freecounterstat.php?c=yxfucgq6e9u3srx9n2xjtx6tq1prcy9m" border="0" title="free counters" alt="free counters"></a>

<pre> 
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣀⣀⣤⣤⣤⣤⣤⣤⣤⣤⣀⣀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣤⠾⠛⠉⠉⠀⠀⠀⠀⠀⠀⢀⡤⠊⠉⠉⠛⠳⣦⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣤⠾⠋⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢮⡀⠀⠀⠀⠀⠀⠀⠙⢷⣤⡀⠀⠀...ah?⠀⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣴⠟⡡⢤⠀⠀⠀⢰⣛⣉⣉⣓⠢⣄⠀⠀⠀⠈⢉⡁⠐⠒⠒⠂⠉⠉⠉⠛⢶⣄⠀⠀⠀⠀⠀⠀⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⡞⠁⣘⡒⠁⢀⠀⠀⠀⣀⣀⣀⣈⣹⣾⣕⠀⢠⡎⠁⡹⠀⣠⠄⠀⠀⠀⠀⠀⠀⠙⢷⡀⠀⠀⠀⠀⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⢠⡟⢀⣎⡩⠃⢠⣏⡴⠞⠛⠉⠉⠀⠀⠀⠀⠹⡏⠀⠉⠉⣠⣾⠖⠋⠉⠻⣅⠀⣠⠖⢲⠌⢻⡄⠀⠀⠀⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⣿⡠⠔⢿⠀⢀⡟⠉⠀⠀⠀⣀⣤⣤⡀⠀⠀⠀⣿⠀⠀⠀⡼⠉⠉⠒⢦⣀⠘⠷⡛⠒⡿⣄⠈⣷⠀⠀⠀⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⢸⡏⠀⣠⠏⠀⢸⠀⠀⠀⠀⢰⣿⣿⣿⡇⠀⠀⢀⡿⠀⠀⣸⠃⠀⠀⣀⣄⡙⢷⣄⡇⠘⠀⢸⡆⢹⡀⠀⠀⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⢸⣧⠞⠁⠀⠀⢸⡆⠀⠀⠀⠸⣿⣿⡿⠃⠀⢀⣼⠃⠀⠀⣿⣆⠀⠀⣿⣿⡟⠀⠙⣧⠳⡤⠞⠀⢸⡇⠀⠀⠀⠀
    ⠀⢀⣠⠤⠤⢄⡀⠈⣧⢈⣧⠀⠀⢸⣿⣄⣀⣀⣠⣬⣥⠴⠶⢚⣿⠋⠀⠀⠀⢻⣿⣦⣄⠈⠁⠀⠀⣰⠟⠆⠀⠀⠀⢸⣡⠴⠖⠶⣦
    ⢠⠏⠀⠀⠀⢀⠈⠓⢿⡄⢳⠀⠀⠀⢳⣌⠻⠯⣤⣀⣀⣀⣴⣿⠏⢀⣶⢰⣦⠈⢿⣿⣿⣷⣀⣠⡼⠋⠀⢀⡀⠀⢀⣿⠥⢄⠀⠀⣿
    ⣏⠀⠀⠀⡟⢉⡽⣦⡈⢻⣼⠄⠀⠀⠀⠉⠓⠦⠤⠬⣏⣡⠾⠃⢀⣾⣿⢸⣿⣇⠈⠻⡯⠽⢯⡽⠁⠠⣴⠝⠃⢀⣾⢋⣁⠈⢀⡾⠃
    ⠘⠶⠲⢦⣷⠸⣤⣸⡇⠀⢻⣦⡀⠀⠀⠀⠀⠀⠀⠉⠁⠀⠀⠀⠘⠛⠋⠘⠋⠋⠀⠀⠑⠚⠉⠀⠀⠀⠈⣠⣠⡾⠳⠤⣿⡀⣾⠁⠀
    ⠀⠀⠀⠀⠸⢧⠉⠉⠀⢀⡾⠀⠉⠻⣦⠀⠀⠀⠈⢟⡽⠄⠀⠀⢀⣀⣤⣤⣤⣄⣀⠀⠀⠀⢀⡀⠀⠀⣴⡿⠛⠻⢶⣤⣿⡿⠋⠀⠀
    ⠀⠀⠀⠀⠀⠙⠒⠒⠚⠋⠀⠀⠀⠀⠸⣧⠀⠀⠀⠀⠁⠀⣠⣾⡿⢿⠀⠀⢀⣮⣙⡻⣦⡈⠙⠿⠀⣸⠏⠀⠀⠀⠀⢀⣿⣇⡀⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢿⡆⠀⠀⠀⠀⣼⣿⣿⣇⣸⣷⣶⣾⡀⣯⣻⣿⣿⡄⠀⠀⡿⠀⠀⠀⠀⠀⢻⣾⡛⡇⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⡇⠀⠀⠀⢸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣧⠀⠀⡇⠀⠀⠀⠀⠀⠀⠛⠟⠁⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣧⠀⡀⠀⢸⣿⣿⡟⢻⡿⠿⣇⣿⢸⠿⣿⣿⣿⡏⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣿⠐⡇⠀⠸⣯⠉⠙⠒⣃⣀⣈⣭⣭⣤⣀⣩⡟⠁⠀⠀⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢸⡄⠃⠀⣀⣽⠷⠞⠛⠉⠉⠁⠀⣠⠤⠤⢤⣉⠙⠢⠤⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠸⣧⠀⠘⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⢰⣶⠀⠹⠂⠀⣰⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⠛⠛⠶⢦⣤⣀⣀⠀⠀⠀⠀⢀⣈⣛⣥⣤⠴⠾⠛⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠉⠉⠉⠉⠉⠉⠉⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
</pre>

<script src="https://requirejs.org/docs/release/2.3.6/minified/require.js"></script> 
<script data-main="jquery" src="scripts/main.js"></script>

<script>

require(        ['jquery', 'jquery-ui', 'jscookie','scrambler2'], 
                function($, ui, Cookies, TheScrambler) {
    // usabilità: reset
    $( "#reset" ).on( "click", function() {
        console.log("reset click");
        $("#domanda_scelta").val(""); //trigger per cancellare
    });

    // usabilità: cancella precedente on focus/click
    $( "#domanda_scelta" ).on( "click", function() {
        console.log("domanda_scelta click");
        $("#domanda_scelta").val(""); //cancella
    });

    // check se corretto
    $( "#scegli" ).on( "click", function() {
        console.log("scegli click");

        var my_domanda = $("#domanda_scelta").val();
        console.log(my_domanda);

        var domanda  = Cookies.get('domanda');

        console.log ("confronto (my_risposta): "+my_domanda+" con (risposta): "+domanda);
        if ( my_domanda == domanda )
            {
                alert("Esatto :-) ");
                location.reload(); 
            }
        else if ( my_domanda == "" )
            alert("Aspetta: devi selezionare la domanda! ");
        else 
            alert("Oh no: hai sbagliato :-( ");
    } );   
    
    //start 
    $(document).ready(function() {       
        console.log("init ready...");

        var jqxhr = $.getJSON( "dataset.json", function(data) {
            //console.log( "success" );
            var size     = data["domande"].length;
            $("#sizedataset").html( size );

            //carica autocompletion
            var suggestions = [];
            $.each(data, function(i, item) {
                for ( var j=0; j<size; j++ )
                    suggestions.push( data['domande'][j]['domanda'] );
            });
            suggestions.sort();
            suggestions = suggestions.filter((elemento, indice) => suggestions.indexOf(elemento) === indice);

            console.log( suggestions );
            $( "input#domanda_scelta" ).autocomplete({
                source: suggestions,
                minlength: 2,
                change: function(event, ui) {
                    if (ui.item == null) {
                    event.currentTarget.value = ''; 
                    event.currentTarget.focus();
                    }
                }
            });

        //seleziona risposta / domanda a caso
        var risposta = "none", domanda="none";
        var items    = [];
        
        var who      = Math.floor( Math.random() * ( size ) );
        risposta     = data['domande'][who]['risposta'];
        domanda      = data['domande'][who]['domanda'];

        console.log( domanda );
        console.log( risposta );

        var now = new Date().toUTCString();

        Cookies.set('domanda', ''+domanda);
        Cookies.set('risposta', ''+risposta);

        // document.cookie = "SameSite=Lax;";
        // document.cookie += "Expires="+now+";";
        // document.cookie += domanda+";"+risposta+";"; 

        // versione base diretta
        // $("#risposta").text(risposta);

        // versione avanzata con typing
        $("#risposta").scrambler({ 
            effect      : "charbychar",
            final_text  : "" + risposta,
            speed       : Math.random() * (35 - 5)   + 5,
            reveal      : Math.random() * (130 - 80) + 80
        });
    })
    .done(function() {
        //console.log( "second success" );
    })
    .fail(function() {
        console.log( "ERRORE JSON" );
    })
    .always(function() {
        //console.log( "complete" );
    });
// });

    // fornisci un suggerimento
    $( "#suggerisci" ).on( "click", function() {
        console.log("suggerisco");

        var domanda    = Cookies.get('domanda');
        var suggestion = "";
        console.log( domanda );

        for (var k=0; k<domanda.length; k++){
            var key = Math.floor( Math.random() * ( domanda.length ) );
            var mod = Math.floor( Math.random() * ( 6 ) );
            if ( key % mod == 0 )
                suggestion = suggestion + domanda[k];
            else
                suggestion = suggestion + "*";
        }

        $("#suggerimento").scrambler({ 
            effect      : "charbychar",
            final_text  : "" + suggestion,
            speed       : Math.random() * (35 - 5)   + 5,
            reveal      : Math.random() * (130 - 80) + 80
        });
    });

    });
});

//     jQuery( "#domanda_scelta" ).on( "click", function() {
//         console.log("domanda_scelta click");
//         jQuery("#domanda_scelta").val(""); //cancella
//     });
//     jQuery( "#scegli" ).on( "click", function() {
//         console.log("scegli click");

//         var my_domanda = jQuery("#domanda_scelta").val();
//         console.log(my_domanda);

//         var domanda  = Cookies.get('domanda');

//         console.log ("confronto (my_risposta): "+my_domanda+" con (risposta): "+domanda);
//         if ( my_domanda == domanda )
//             {
//                 alert("Esatto :-) ");
//                 location.reload(); 
//             }
//         else if ( my_domanda == "" )
//             alert("Aspetta: devi selezionare la domanda! ");
//         else 
//             alert("Oh no: hai sbagliato :-( ");
//     } );    
//     jQuery( document ).ready(function() {
//         console.log("init ready...");
//         var jqxhr = jQuery.getJSON( "dataset.json", function(data) {
//             //console.log( "success" );
//             var size     = data["domande"].length;
//             jQuery("#sizedataset").html( size );

//             //carica autocompletion
//             var suggestions = [];
//             jQuery.each(data, function(i, item) {
//                 for ( var j=0; j<size; j++ )
//                     suggestions.push( data['domande'][j]['domanda'] );
//             });
//             suggestions.sort();
//             suggestions = suggestions.filter((elemento, indice) => suggestions.indexOf(elemento) === indice);

//             console.log( suggestions );
//             jQuery( "input#domanda_scelta" ).autocomplete({
//                 source: suggestions,
//                 minlength: 2,
//                 change: function(event, ui) {
//                     if (ui.item == null) {
//                     event.currentTarget.value = ''; 
//                     event.currentTarget.focus();
//                     }
//                 }
//             });

//         //seleziona risposta / domanda a caso
//         var risposta = "none", domanda="none";
//         var items    = [];
        
//         var who      = Math.floor( Math.random() * ( size ) );
//         risposta     = data['domande'][who]['risposta'];
//         domanda      = data['domande'][who]['domanda'];

//         console.log( domanda );
//         console.log( risposta );

//         var now = new Date().toUTCString();

//         Cookies.set('domanda', ''+domanda);
//         Cookies.set('risposta', ''+risposta);

//         // document.cookie = "SameSite=Lax;";
//         // document.cookie += "Expires="+now+";";
//         // document.cookie += domanda+";"+risposta+";"; 

//         // versione base diretta
//         jQuery("#risposta").text(risposta);

//         // versione avanzata con typing
//         // jQuery("#risposta").scrambler({
//         //     effect: "charbychar",
//         //     final_text : ""+risposta,
//         //     speed: 50,
//         //     reveal: 100    // number of miliseconds to reveal one character
//         // });
//     })
//     .done(function() {
//         //console.log( "second success" );
//     })
//     .fail(function() {
//         console.log( "ERRORE JSON" );
//     })
//     .always(function() {
//         //console.log( "complete" );
//     });
// });

    </script>

  </body>
</html>
